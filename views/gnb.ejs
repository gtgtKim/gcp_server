<div class="gnb">
  <div class="menu">
    <a id="menu1" href="/main">MAIN</a>
    <a id="menu2" href="/product-list">PIP</a>
    <a id="menu3" href="/event-list">EVL</a>
  </div>
  <div class="auth-links">
    <% if (isLoggedIn) { %>
    <a id="logoutButton" href="#">Log Out</a> <!-- href="#"로 링크 기본 동작을 막음 -->
    <% } %>
    <a id="loginButton" href="<%= isLoggedIn ? '/mypage' : '/login' %>">
      <%= isLoggedIn ? 'My Page' : 'Login' %>
    </a>
  </div>
</div>

<script>
  document.getElementById("logoutButton").addEventListener("click", function(event) {
    event.preventDefault(); // 기본 링크 동작을 막음

    // 로그아웃 확인 팝업
    const userConfirmed = confirm("로그아웃 하시겠습니까?");

    if (userConfirmed) {
      // 로그아웃을 확정하면 POST 요청을 보냄
      fetch("/logout", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          }
        })
        .then(response => {
          if (response.ok) {
            // 성공하면 현재 URL로 리다이렉트
            window.location.href = window.location.href;
          } else {
            alert("로그아웃에 실패했습니다. 다시 시도해 주세요.");
          }
        })
        .catch(error => {
          console.error("Error:", error);
          alert("로그아웃 중 오류가 발생했습니다.");
        });
    }
  });
</script>